<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jargen - Astrophotography</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/megajs@latest/dist/main.browser-es5.js"></script>
</head>
<body>

    <!-- Header Section -->
    <header>
        <h1>Jargen - Astrophotography</h1>
    </header>

    <!-- Navigation Menu -->
    <nav>
        <a href="index.html">Home</a>
		<a href="https://github.com/jacobcargen">GitHub</a>
        <a href="projects.html">Projects</a>
        <a href="mods.html">Mods</a>
        <a href="astrophotography.html">Astrophotography</a>
    </nav>

    <!-- Astrophotography Section -->
    <section id="astrophotography">
        <h2>Astrophotography</h2>
        <div id="loading-message">Loading photos from MEGA...</div>
        <div class="astro-gallery" id="astro-gallery">
            <!-- Photos will be dynamically loaded here -->
        </div>
    </section>

    <script>
        // MEGA folder URL: https://mega.nz/folder/38wxDI7L#OmdDV4UiESO9LEJ9lyFElw
        const MEGA_FOLDER_ID = '38wxDI7L';
        const MEGA_FOLDER_KEY = 'OmdDV4UiESO9LEJ9lyFElw';

        async function loadMegaPhotos() {
            const gallery = document.getElementById('astro-gallery');
            const loadingMessage = document.getElementById('loading-message');
            
            try {
                // Parse the MEGA folder link
                const folderUrl = `https://mega.nz/folder/${MEGA_FOLDER_ID}#${MEGA_FOLDER_KEY}`;
                const folder = mega.File.fromURL(folderUrl);
                
                // Load the folder
                await folder.loadAttributes();
                
                // Get all files in the folder
                const files = [];
                for await (const file of folder.children) {
                    // Only process image files
                    if (file.name && /\.(jpg|jpeg|png|gif|webp)$/i.test(file.name)) {
                        files.push(file);
                    }
                }
                
                // Sort files by name
                files.sort((a, b) => a.name.localeCompare(b.name));
                
                // Clear loading message
                loadingMessage.style.display = 'none';
                
                // Create photo elements
                for (const file of files) {
                    const photoDiv = document.createElement('div');
                    photoDiv.className = 'astro-photo';
                    
                    // Get download link
                    const link = await file.link();
                    
                    // Create image element
                    const img = document.createElement('img');
                    img.src = link;
                    img.alt = file.name;
                    img.loading = 'lazy'; // Lazy load images for better performance
                    
                    // Create photo info
                    const photoInfo = document.createElement('div');
                    photoInfo.className = 'photo-info';
                    const photoName = document.createElement('p');
                    // Remove file extension and format name
                    photoName.textContent = file.name.replace(/\.[^/.]+$/, '').replace(/_/g, ' ');
                    photoInfo.appendChild(photoName);
                    
                    photoDiv.appendChild(img);
                    photoDiv.appendChild(photoInfo);
                    gallery.appendChild(photoDiv);
                }
                
            } catch (error) {
                console.error('Error loading MEGA photos:', error);
                loadingMessage.textContent = 'Error loading photos. Please try again later.';
                loadingMessage.style.color = '#ff6b6b';
            }
        }
        
        // Load photos when page loads
        window.addEventListener('DOMContentLoaded', loadMegaPhotos);
    </script>

    <!-- Footer Section -->
    <footer>
        <p>&copy; 2024 Jacob Cargen | All Rights Reserved | <a href="privacy.html">Privacy Policy</a></p>
    </footer>

</body>
</html>
